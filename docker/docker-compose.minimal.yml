version: "3.3"

services:
  damap-be:
    # Since DAMAP containers are publicly available on Github packages one can
    # just pull the latest container image.
    image: ghcr.io/sharedrdm/damap-backend:${DAMAP_BE_VERSION}
    pull_policy: always
    restart: unless-stopped
    depends_on:
      - fits-service
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/q/health/live"]
      interval: 30s
      timeout: 15s
      retries: 5

  damap-fe:
    # Since DAMAP containers are publicly available on Github packages one can
    # just pull the latest container image.
    image: ghcr.io/sharedrdm/damap-frontend:${DAMAP_FE_VERSION}
    pull_policy: always
    restart: unless-stopped
    depends_on:
      - damap-be

  fits-service:
    image: islandora/fits:main
    pull_policy: always
    restart: unless-stopped
    ports:
      - "8089:8080"
